<?php declare(strict_types=1);
namespace Open;

use PHPUnit\Framework\{TestCase};
use function PHPUnit\Framework\{assertThat, isNull};

/** @testdox Open\open */
class OpenTest extends TestCase {

	/** @testdox open() */
	function testOpen(): void {
		$googleChrome = PHP_OS_FAMILY == "Darwin" ? "google chrome" : (PHP_OS_FAMILY == "Windows" ? "chrome" : "google-chrome");

		// It should open files in the default application.
		open(__FILE__);

		// It should open URLs in the default application.
		open("https://belin.io");

		// It should open URLs in the given application.
		open("https://belin.io", ["application" => "firefox"]);

		// It should open URLs in the given application with arguments.
		open("https://belin.io", ["application" => $googleChrome, "arguments" => ["--incognito"]]);

		// It should wait for the application to close.
		open("https://belin.io", ["application" => $googleChrome, "wait" => true]);

		if (Wsl::isWsl()) {
			$googleChromeWsl = "/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe";

			// It should open URLs in the specified application by using a given WSL path.
			open("https://belin.io", ["application" => $googleChromeWsl]);

			// It should open URLs in the specified application with arguments by using a given WSL path.
			open("https://belin.io", ["application" => $googleChromeWsl, "arguments" => ["--incognito"]]);
		}

		// Mark this test as not risky.
		assertThat(null, isNull());
	}
}
